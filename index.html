<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Display Image from BIN File</title>
</head>
<body>
    <canvas id="imageCanvas" width="500" height="500"></canvas>
    <script>
        async function fetchBinFile(filePath) {
            const response = await fetch(filePath);
            const buffer = await response.arrayBuffer();
            return buffer;
        }

        function loadImagesFromBuffer(buffer) {
            const dataView = new DataView(buffer);

            let offset = 0;
            const fileCount = dataView.getInt32(offset, true);
            offset += 4;

            const imgs = [];

            for (let i = 0; i < fileCount; i++) {
                const jpegDataLength = dataView.getInt32(offset, true);
                offset += 4;

                const jpegData = new Uint8Array(buffer, offset, jpegDataLength);
                offset += jpegDataLength;

                const blob = new Blob([jpegData], { type: 'image/jpeg' });
                const imageUrl = URL.createObjectURL(blob);

                const image = new Image();
                image.src = imageUrl;
                imgs.push(image);
            }

            return imgs;
        }

        function displayImage(image) {
            const canvas = document.getElementById('imageCanvas');
            const ctx = canvas.getContext('2d');
            image.onload = function() {
                ctx.drawImage(image, 0, 0, canvas.width, canvas.height);
            };
        }

        async function init() {
            const buffer = await fetchBinFile('Images/output.bin');
            const images = loadImagesFromBuffer(buffer);
            if (images.length > 0) {
                displayImage(images[0]);
            }
        }

        window.onload = init;
    </script>
</body>
</html>
